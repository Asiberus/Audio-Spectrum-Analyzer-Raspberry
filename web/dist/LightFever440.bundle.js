window.LightFever440=function(){"use strict";var t={872:function(t,e){function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,o=void 0;try{for(var a,r=t[Symbol.iterator]();!(i=(a=r.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){s=!0,o=t}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._dom={toggle:document.getElementById("toggle-light-fever"),manual:document.getElementById("manual-mode"),analyzer:document.getElementById("analyzer-mode"),selection:document.getElementById("selection-border"),manualContainer:document.getElementById("manual-container"),autoContainer:document.getElementById("auto-container"),themeSwitch:document.getElementById("theme-switch"),status:document.getElementById("status-text"),manualButtons:{uniform:document.getElementById("manual-uniform"),strob:document.getElementById("manual-stroboscope"),chase:document.getElementById("manual-chase"),rainbow:document.getElementById("manual-rainbow"),rainbowChase:document.getElementById("manual-chase-rainbow")},autoButtons:{uniform:document.getElementById("auto-uniform"),progressive:document.getElementById("auto-progressive"),progMirror:document.getElementById("auto-progressive-mirror")}},this._isActive=!1,this._isDark=!0,this._state="OFF",this._mode="MANUAL",this._effect=null,this._options=null,this._events()}var e,i;return e=t,(i=[{key:"_events",value:function(){this._dom.toggle.addEventListener("click",this._toggleLightFever.bind(this)),this._dom.manual.addEventListener("click",this._switchMode.bind(this)),this._dom.analyzer.addEventListener("click",this._switchMode.bind(this)),this._dom.themeSwitch.addEventListener("click",this._switchTheme.bind(this)),this._dom.manualButtons.uniform.addEventListener("click",this._updateEffect.bind(this)),this._dom.manualButtons.strob.addEventListener("click",this._updateEffect.bind(this)),this._dom.manualButtons.chase.addEventListener("click",this._updateEffect.bind(this)),this._dom.manualButtons.rainbow.addEventListener("click",this._updateEffect.bind(this)),this._dom.manualButtons.rainbowChase.addEventListener("click",this._updateEffect.bind(this)),this._dom.autoButtons.uniform.addEventListener("click",this._updateEffect.bind(this)),this._dom.autoButtons.progressive.addEventListener("click",this._updateEffect.bind(this)),this._dom.autoButtons.progMirror.addEventListener("click",this._updateEffect.bind(this))}},{key:"_toggleLightFever",value:function(){!1===this._isActive?(this._isActive=!0,this._dom.toggle.innerHTML="ON",this._dom.toggle.classList.remove("light-fever-off"),this._dom.toggle.classList.add("light-fever-on"),this._startLightFever()):(this._isActive=!1,this._dom.toggle.innerHTML="OFF",this._dom.toggle.classList.remove("light-fever-on"),this._dom.toggle.classList.add("light-fever-off"),this._stopLightFever())}},{key:"_startLightFever",value:function(){var t=this;this._state="ON",this.sendAction().then((function(){t._dom.status.innerHTML="Light Fever 440 started"})).catch((function(){t._dom.status.innerHTML="Unable to start Light Fever 440"}))}},{key:"_stopLightFever",value:function(){var t=this;this._state="OFF",this.sendAction().then((function(){t._dom.status.innerHTML="Light Fever 440 stopped"})).catch((function(){t._dom.status.innerHTML="Unable to stop Light Fever 440"}))}},{key:"_switchMode",value:function(t){"false"===t.target.dataset.manual?(this._dom.manual.classList.remove("selected"),this._dom.analyzer.classList.add("selected"),this._dom.selection.style.left="50%",this._dom.manualContainer.style.left="-100%",this._dom.autoContainer.style.left="0",this._mode="AUDIO_ANALYSE",this._dom.status.innerHTML="Audio analyzer activated"):(this._dom.analyzer.classList.remove("selected"),this._dom.manual.classList.add("selected"),this._dom.selection.style.left="0",this._dom.manualContainer.style.left="0",this._dom.autoContainer.style.left="100%",this._mode="MANUAL",this._dom.status.innerHTML="Manual control activated"),this.sendAction()}},{key:"_switchTheme",value:function(t){!0===t.target.checked?(this._isDark=!1,document.body.classList.remove("dark-theme"),document.body.classList.add("light-theme"),this._dom.status.innerHTML="Switched to light theme"):(this._isDark=!0,document.body.classList.remove("light-theme"),document.body.classList.add("dark-theme"),this._dom.status.innerHTML="Switched to dark theme")}},{key:"_updateEffect",value:function(t){var e=this;if("MANUAL"===this._mode)for(var i=0,s=Object.entries(this._dom.manualButtons);i<s.length;i++){var o=n(s[i],2),a=o[0];o[1],this._dom.manualButtons[a].classList.remove("selected")}else for(var r=0,d=Object.entries(this._dom.autoButtons);r<d.length;r++){var c=n(d[r],2),u=c[0];c[1],this._dom.autoButtons[u].classList.remove("selected")}t.target.classList.add("selected"),this._effect=t.target.dataset.effect,this.sendAction().then((function(){e._dom.status.innerHTML="Effect ".concat(e._effect," activated")})).catch((function(){e._dom.status.innerHTML="Unable to set effect ".concat(e._effect)}))}},{key:"sendAction",value:function(){var t=this;return new Promise((function(e,n){t.ajax({state:t._state,mode:t._mode,effect:t._effect,options:t._options}).then(e).catch(n)}))}},{key:"ajax",value:function(t){return new Promise((function(e,n){var i={method:"POST",headers:new Headers([["Content-Type","application/json; charset=UTF-8"],["Accept","application/json"]]),body:JSON.stringify(t)};fetch("action",i).then((function(t){t?t.ok?e(t.json()):n("ERROR_".concat(t.status)):n("ERROR_MISSING_ARGUMENT")})).catch(n)}))}}])&&s(e.prototype,i),t}();e.default=o}},e={};return function n(i){if(e[i])return e[i].exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}(872)}().default;