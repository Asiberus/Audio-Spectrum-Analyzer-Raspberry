window.LightFever440=function(){"use strict";var e={215:function(e,t,o){function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}o.d(t,{default:function(){return w}});var i=function(){function e(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dom={overlay:document.getElementById("modal-overlay"),stroboscope:{container:document.getElementById("stroboscope-modal"),delay:document.getElementById("strob-delay"),delayText:document.getElementById("strob-delay-value"),color:document.getElementById("strob-color")},colorPicker:{container:document.getElementById("color-picker-modal")}},"STROBOSCOPE"===t?(window.rangesliderJs.create(this._dom.stroboscope.delay,{value:window.localStorage.getItem("strob-delay")||"50"}),this._stroboscopeModal()):"COLOR_PICKER"===t&&this._colorPickerModal(o.color,o.callback)}var t,o;return t=e,(o=[{key:"_stroboscopeModal",value:function(){var e=this;this._dom.overlay.classList.add("visible"),this._dom.stroboscope.container.classList.add("visible");var t=function(t){e._dom.stroboscope.delayText.innerHTML=t.target.value,window.localStorage.setItem("strob-delay",t.target.value)},o=function(i){"strob-modal-close"!==i.target.id&&"modal-overlay"!==i.target.id||(e._dom.overlay.classList.remove("visible"),e._dom.stroboscope.container.classList.remove("visible"),e._dom.stroboscope.delay.removeEventListener("click",t),e._dom.overlay.removeEventListener("click",o),document.getElementById("strob-modal-close").removeEventListener("click",o),n.destroy())};t=t.bind(this),o=o.bind(this);var n=new window.KellyColorPicker({place:"strob-color-picker",color:window.localStorage.getItem("strob-color")||"#ffffff",changeCursor:!1,userEvents:{change:function(e){window.localStorage.setItem("strob-color",e.getCurColorHex()),document.getElementById("strob-color").value=e.getCurColorHex()}}});document.getElementById("strob-color").addEventListener("click",(function(e){e.preventDefault()})),this._dom.stroboscope.delay.addEventListener("input",t),this._dom.overlay.addEventListener("click",o),document.getElementById("strob-modal-close").addEventListener("click",o)}},{key:"_colorPickerModal",value:function(e,t){var o=this;this._dom.overlay.classList.add("visible"),this._dom.colorPicker.container.classList.add("visible");var n=function(e){"color-picker-modal-close"!==e.target.id&&"modal-overlay"!==e.target.id||(o._dom.overlay.classList.remove("visible"),o._dom.colorPicker.container.classList.remove("visible"),o._dom.overlay.removeEventListener("click",n),document.getElementById("color-picker-modal-close").removeEventListener("click",n),t(i.getCurColorHex()))};n=n.bind(this);var i=new window.KellyColorPicker({place:"color-picker",color:e||"#ffffff",changeCursor:!1,userEvents:{change:function(e){document.getElementById("output-color").value=e.getCurColorHex()}}});this._dom.overlay.addEventListener("click",n),document.getElementById("color-picker-modal-close").addEventListener("click",n)}}])&&n(t.prototype,o),e}();function s(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[255,255,255]}function a(e,t){return new Promise((function(o,n){var i={method:t?"POST":"GET",headers:new Headers([["Content-Type","application/json; charset=UTF-8"],["Accept","application/json"]]),body:JSON.stringify(t)};fetch(e,i).then((function(e){e?e.ok?o(e.json()):n("ERROR_".concat(e.status)):n("ERROR_MISSING_ARGUMENT")})).catch(n)}))}function c(e,t){return new i("COLOR_PICKER",{color:e,callback:function(e){t(e)}})}function l(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._scope=t.scope,this._update=t.update}var t,o;return t=e,(o=[{key:"new",value:function(e,t){"CLICK"===e?this._clickEvent(t):"SWITCH"===e?this._createSwitch(t):"SLIDER"===e?this._createSlider(t):"COLOR"===e?this._createColor(t):"COLOR_OVERRIDE"===e&&this._createColorOverride(t)}},{key:"_clickEvent",value:function(e){this._event("click",e,!1)}},{key:"_createSwitch",value:function(e){this._event("change",e,!0,!0)}},{key:"_event",value:function(e,t,o){var n=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t.element.addEventListener(e,(function(){!0===o&&(!0===i?window.localStorage.setItem(t.lsKey,t.element.checked):window.localStorage.setItem(t.lsKey,t.element.value)),n._update.call(n._scope,t.effect)}))}},{key:"_createSlider",value:function(e){window.rangesliderJs.create(e.element,{value:window.localStorage.getItem(e.lsKey)||e.default}),this._event("change",e,!0,!1),e.element.addEventListener("input",(function(){window.localStorage.setItem(e.lsKey,e.element.value),e.label.innerHTML=e.element.value}))}},{key:"_createColor",value:function(e){var t=this;e.element.addEventListener("click",(function(o){o.preventDefault(),c(window.localStorage.getItem(e.lsKey),(function(o){window.localStorage.setItem(e.lsKey,o),e.element.value=o,t._update.call(t._scope,e.effect)}))}))}},{key:"_createColorOverride",value:function(e){var t=this;this._event("change",e,!0,!0),e.element.addEventListener("input",(function(){window.localStorage.setItem("".concat(e.lsKey,"-switch"),e.element.checked),e.element.checked?e.color.parentNode.style.filter="opacity(1)":e.color.parentNode.style.filter="opacity(0.1)"})),e.color.addEventListener("click",(function(o){o.preventDefault(),!0===e.element.checked&&c(window.localStorage.getItem(e.lsKey),(function(o){window.localStorage.setItem(e.lsKey,o),e.color.value=o,t._update.call(t._scope,e.effect)}))}))}}])&&l(t.prototype,o),e}();function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],n=!0,i=!1,s=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(o.push(a.value),!t||o.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw s}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function m(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dom={UNIFORM:{button:document.getElementById("manual-uniform"),container:document.getElementById("manual-uniform-options"),color:document.getElementById("manual-uniform-color"),waveDelta:document.getElementById("manual-uniform-wave-delta"),waveDeltaText:document.getElementById("manual-uniform-wave-delta-value")},CHASE:{button:document.getElementById("manual-chase"),container:document.getElementById("manual-chase-options"),color:document.getElementById("manual-chase-color"),delay:document.getElementById("manual-chase-delay"),delayText:document.getElementById("manual-chase-delay-value"),size:document.getElementById("manual-chase-size"),sizeText:document.getElementById("manual-chase-size-value"),spacing:document.getElementById("manual-chase-spacing"),spacingText:document.getElementById("manual-chase-spacing-value"),rainbow:document.getElementById("manual-chase-rainbow")},RAINBOW:{button:document.getElementById("manual-rainbow"),container:document.getElementById("manual-rainbow-options"),speed:document.getElementById("manual-rainbow-speed"),speedText:document.getElementById("manual-rainbow-speed-value")}},this._inputFactory=new r({scope:this,update:this._updateEffect}),this._initState(),this._initEvents()}var t,o;return t=e,(o=[{key:"_initState",value:function(){this._dom.UNIFORM.color.value=window.localStorage.getItem("manual-uniform-color")||"#FFFFFF",this._dom.CHASE.color.value=window.localStorage.getItem("manual-chase-color")||"#FFFFFF",this._dom.UNIFORM.waveDeltaText.innerHTML=window.localStorage.getItem("manual-uniform-wave-delta")||"0",this._dom.CHASE.delayText.innerHTML=window.localStorage.getItem("manual-chase-delay")||"50",this._dom.CHASE.sizeText.innerHTML=window.localStorage.getItem("manual-chase-size")||"1",this._dom.CHASE.spacingText.innerHTML=window.localStorage.getItem("manual-chase-spacing")||"2",this._dom.CHASE.rainbow.checked="true"===window.localStorage.getItem("manual-chase-rainbow"),this._dom.RAINBOW.speedText.innerHTML=window.localStorage.getItem("manual-rainbow-speed")||"50"}},{key:"_initEvents",value:function(){this._inputFactory.new("CLICK",{effect:"UNIFORM",element:this._dom.UNIFORM.button}),this._inputFactory.new("COLOR",{effect:"UNIFORM",element:this._dom.UNIFORM.color,lsKey:"manual-uniform-color"}),this._inputFactory.new("SLIDER",{effect:"UNIFORM",element:this._dom.UNIFORM.waveDelta,label:this._dom.UNIFORM.waveDeltaText,default:"0",lsKey:"manual-uniform-wave-delta"}),this._inputFactory.new("CLICK",{effect:"CHASE",element:this._dom.CHASE.button}),this._inputFactory.new("COLOR",{effect:"CHASE",element:this._dom.CHASE.color,lsKey:"manual-chase-color"}),this._inputFactory.new("SLIDER",{effect:"CHASE",element:this._dom.CHASE.delay,label:this._dom.CHASE.delayText,default:"0",lsKey:"manual-chase-delay"}),this._inputFactory.new("SLIDER",{effect:"CHASE",element:this._dom.CHASE.size,label:this._dom.CHASE.sizeText,default:"0",lsKey:"manual-chase-size"}),this._inputFactory.new("SLIDER",{effect:"CHASE",element:this._dom.CHASE.spacing,label:this._dom.CHASE.spacingText,default:"0",lsKey:"manual-chase-spacing"}),this._inputFactory.new("SWITCH",{effect:"CHASE",element:this._dom.CHASE.rainbow,lsKey:"manual-chase-rainbow"}),this._inputFactory.new("CLICK",{effect:"RAINBOW",element:this._dom.RAINBOW.button}),this._inputFactory.new("SLIDER",{effect:"RAINBOW",element:this._dom.RAINBOW.speed,label:this._dom.RAINBOW.speedText,default:"0",lsKey:"manual-rainbow-speed"})}},{key:"_updateEffect",value:function(e){var t=e;"string"!=typeof e&&(t=e.target.dataset.effect),this._unselectAllEffect(),window.LF440.effect=t,this._dom[window.LF440.effect].container.style.display="block",this._dom[window.LF440.effect].button.classList.add("selected"),!0===window.LF440.isActive?window.LF440.sendAction().then((function(){window.LF440.status="Effect ".concat(window.LF440.effect," activated"),console.log("ManualController : Successfully activate effect ".concat(window.LF440.effect))})).catch((function(){window.LF440.status="Unable to set effect ".concat(window.LF440.effect),console.error("ManualController : Failed to activate effect ".concat(window.LF440.effect))})):(window.LF440.status="Please start LightFever440",console.error("ManualController : Failed to activate effect ".concat(window.LF440.effect,", LightFever440 isn't activated")))}},{key:"_unselectAllEffect",value:function(){for(var e=0,t=Object.entries(this._dom);e<t.length;e++){var o=d(t[e],1)[0];this._dom[o].button.classList.remove("selected"),this._dom[o].container.style.display="none"}}},{key:"initEffect",value:function(e){this._unselectAllEffect(),this._dom[e].button.classList.add("selected"),this._dom[e].container.style.display="block"}},{key:"getActiveEffect",value:function(){for(var e=0,t=Object.entries(this._dom);e<t.length;e++){var o=d(t[e],1)[0];if(this._dom[o].button.classList.contains("selected"))return this._dom[o].container.style.display="block",this._dom[o].button.dataset.effect}return"UNIFORM"}},{key:"getOptions",value:function(){var e={};return"UNIFORM"===window.LF440.effect?e={color:s(window.localStorage.getItem("manual-uniform-color")),waveDelta:parseInt(this._dom.UNIFORM.waveDelta.value)}:"CHASE"===window.LF440.effect?e={color:s(window.localStorage.getItem("manual-chase-color")),delay:parseInt(this._dom.CHASE.delay.value),size:parseInt(this._dom.CHASE.size.value),spacing:parseInt(this._dom.CHASE.spacing.value),rainbow:this._dom.CHASE.rainbow.checked}:"RAINBOW"===window.LF440.effect&&(e={speed:parseInt(this._dom.RAINBOW.speed.value)}),e}}])&&m(t.prototype,o),e}();function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],n=!0,i=!1,s=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(o.push(a.value),!t||o.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw s}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function y(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dom={UNIFORM:{button:document.getElementById("auto-uniform"),container:document.getElementById("auto-uniform-options"),peakDetection:document.getElementById("auto-uniform-peak-detection"),peakSensitivity:document.getElementById("auto-uniform-peak-sensitivity"),peakSensitivityText:document.getElementById("auto-uniform-peak-sensitivity-value"),colorSwitch:document.getElementById("auto-uniform-color-switch"),color:document.getElementById("auto-uniform-color")},PROGRESSIVE:{button:document.getElementById("auto-progressive"),container:document.getElementById("auto-progressive-options"),size:document.getElementById("auto-progressive-size"),sizeText:document.getElementById("auto-progressive-size-value"),reverse:document.getElementById("auto-progressive-reverse")},PULSE:{button:document.getElementById("auto-pulse"),container:document.getElementById("auto-pulse-options"),maxLength:document.getElementById("auto-pulse-length"),maxLengthText:document.getElementById("auto-pulse-length-value"),colorSwitch:document.getElementById("auto-pulse-color-switch"),color:document.getElementById("auto-pulse-color")}},this._inputFactory=new r({scope:this,update:this._updateEffect}),this._initState(),this._initEvents()}var t,o;return t=e,(o=[{key:"_initState",value:function(){}},{key:"_initEvents",value:function(){this._inputFactory.new("CLICK",{effect:"UNIFORM",element:this._dom.UNIFORM.button}),this._inputFactory.new("SWITCH",{effect:"UNIFORM",element:this._dom.UNIFORM.peakDetection,lsKey:"auto-uniform-peak-detection"}),this._inputFactory.new("SLIDER",{effect:"UNIFORM",element:this._dom.UNIFORM.peakSensitivity,label:this._dom.UNIFORM.peakSensitivityText,default:"0",lsKey:"auto-uniform-peak-sensitivity"}),this._inputFactory.new("COLOR_OVERRIDE",{effect:"UNIFORM",element:this._dom.UNIFORM.colorSwitch,color:this._dom.UNIFORM.color,lsKey:"auto-uniform-color"}),this._inputFactory.new("CLICK",{effect:"PROGRESSIVE",element:this._dom.PROGRESSIVE.button}),this._inputFactory.new("SWITCH",{effect:"PROGRESSIVE",element:this._dom.PROGRESSIVE.reverse,lsKey:"auto-progressive-reverse"}),this._inputFactory.new("SLIDER",{effect:"PROGRESSIVE",element:this._dom.PROGRESSIVE.size,label:this._dom.PROGRESSIVE.sizeText,default:"5",lsKey:"auto-progressive-size"}),this._inputFactory.new("CLICK",{effect:"PULSE",element:this._dom.PULSE.button}),this._inputFactory.new("SLIDER",{effect:"PULSE",element:this._dom.PULSE.maxLength,label:this._dom.PULSE.maxLengthText,default:"100",lsKey:"auto-pulse-length"}),this._inputFactory.new("COLOR_OVERRIDE",{effect:"PULSE",element:this._dom.PULSE.colorSwitch,color:this._dom.PULSE.color,lsKey:"auto-pulse-color"})}},{key:"_updateEffect",value:function(e){var t=e;"string"!=typeof e&&(t=e.target.dataset.effect),this._unselectAllEffect(),window.LF440.effect=t,this._dom[window.LF440.effect].container.style.display="block",this._dom[window.LF440.effect].button.classList.add("selected"),!0===window.LF440.isActive?window.LF440.sendAction().then((function(){window.F440.status="Effect ".concat(window.LF440.effect," activated"),console.log("AnalyzerController : Successfully activate effect ".concat(window.LF440.effect))})).catch((function(){window.LF440.status="Unable to set effect ".concat(window.LF440.effect),console.error("AnalyzerController : Failed to activate effect ".concat(window.LF440.effect))})):(window.LF440.status="Please start LightFever440",console.error("AnalyzerController : Failed to activate effect ".concat(window.LF440.effect,", LightFever440 isn't activated")))}},{key:"_unselectAllEffect",value:function(){for(var e=0,t=Object.entries(this._dom);e<t.length;e++){var o=h(t[e],1)[0];this._dom[o].button.classList.remove("selected"),this._dom[o].container.style.display="none"}}},{key:"initEffect",value:function(e){this._unselectAllEffect(),this._dom[e].button.classList.add("selected"),this._dom[e].container.style.display="block"}},{key:"getActiveEffect",value:function(){for(var e=0,t=Object.entries(this._dom);e<t.length;e++){var o=h(t[e],1)[0];if(this._dom[o].button.classList.contains("selected"))return this._dom[o].container.style.display="block",this._dom[o].button.dataset.effect}return"UNIFORM"}},{key:"getOptions",value:function(){var e={};return"UNIFORM"===window.LF440.effect?(e={peakDetection:this._dom.UNIFORM.peakDetection.checked,peakSensitivity:parseInt(this._dom.UNIFORM.peakSensitivity.value)/100},this._dom.UNIFORM.colorSwitch.checked&&(e.color=s(this._dom.UNIFORM.color.value))):"PROGRESSIVE"===window.LF440.effect?e={size:parseInt(this._dom.PROGRESSIVE.size.value),reverse:this._dom.PROGRESSIVE.reverse.checked}:"PULSE"===window.LF440.effect&&(e={max:parseInt(this._dom.PULSE.maxLength.value)/100},this._dom.PULSE.colorSwitch.checked&&(e.color=s(this._dom.PULSE.color))),e}}])&&y(t.prototype,o),e}();function g(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.VERSION="0.0.1",this._dom={title:document.getElementById("title"),version:document.getElementById("version"),toggle:document.getElementById("toggle-light-fever"),manual:document.getElementById("manual-mode"),analyzer:document.getElementById("analyzer-mode"),selection:document.getElementById("selection-border"),manualContainer:document.getElementById("manual-container"),autoContainer:document.getElementById("auto-container"),themeSwitch:document.getElementById("theme-switch"),status:document.getElementById("status-text"),globalButtons:{STROBOSCOPE:document.getElementById("global-stroboscope"),strobOpts:document.getElementById("strob-opts")}},this._isActive=!1,this._isDark=!0,this._previousEffect=null,this._state="OFF",this._mode="MANUAL",this._effect="UNIFORM",this._options=null,this._mc=new f,this._ac=new _,console.log("LightFever440.js - Version ".concat(this.VERSION)),this._initEvents(),this._initState()}var t,o;return t=e,(o=[{key:"_initEvents",value:function(){this._dom.toggle.addEventListener("click",this._toggleLightFever.bind(this)),this._dom.manual.addEventListener("click",this._switchMode.bind(this)),this._dom.analyzer.addEventListener("click",this._switchMode.bind(this)),this._dom.themeSwitch.addEventListener("click",this._switchTheme.bind(this)),this._dom.globalButtons.STROBOSCOPE.addEventListener("touchstart",this._startStroboscope.bind(this)),this._dom.globalButtons.STROBOSCOPE.addEventListener("touchend",this._stopStroboscope.bind(this)),this._dom.globalButtons.strobOpts.addEventListener("click",this._stroboscopeModal.bind(this))}},{key:"_initState",value:function(){var e=this;"light"===window.localStorage.getItem("theme")&&(this._isDark=!1,document.body.classList.remove("dark-theme"),document.body.classList.add("light-theme"),this._dom.themeSwitch.checked=!0,this._dom.status.innerHTML="Switched to light theme"),this._dom.version.innerHTML=this.VERSION,this._getState().then((function(t){e._dom.status.innerHTML="Set Light Fever 440 state","ON"===t.state&&(e._isActive=!0,e._dom.toggle.innerHTML="ON",e._dom.toggle.classList.remove("light-fever-off"),e._dom.toggle.classList.add("light-fever-on")),"AUDIO_ANALYSE"===t.mode&&(e._dom.manual.classList.remove("selected"),e._dom.analyzer.classList.add("selected"),e._dom.selection.style.left="50%",e._dom.manualContainer.style.left="-100%",e._dom.autoContainer.style.left="0",e._mode="AUDIO_ANALYSE"),"UNIFORM"!==t.effect&&("MANUAL"===e._mode?e._mc.initEffect(t.effect):e._ac.initEffect(t.effect)),e._effect=t.effect,console.error("LightFever440 : Light system state preoperly loaded")})).catch((function(t){e._dom.status.innerHTML="Unable to load state",console.error("LightFever440 : Unable to load light system state",t)}))}},{key:"_toggleLightFever",value:function(){!1===this._isActive?(this._isActive=!0,this._dom.toggle.innerHTML="ON",this._dom.toggle.classList.remove("light-fever-off"),this._dom.toggle.classList.add("light-fever-on"),this._startLightFever()):(this._isActive=!1,this._dom.toggle.innerHTML="OFF",this._dom.toggle.classList.remove("light-fever-on"),this._dom.toggle.classList.add("light-fever-off"),this._stopLightFever())}},{key:"_startLightFever",value:function(){var e=this;this._dom.title.classList.add("activated"),this._dom.version.classList.add("activated"),this._state="ON",this.sendAction().then((function(){e._dom.status.innerHTML="Light Fever 440 started",console.log("LightFever440 : Light system successfully started")})).catch((function(t){e._dom.status.innerHTML="Unable to start Light Fever 440",console.error("LightFever440 : Unable to start light system",t)}))}},{key:"_stopLightFever",value:function(){var e=this;this._dom.title.classList.remove("activated"),this._dom.version.classList.remove("activated"),this._state="OFF",this.sendAction().then((function(){e._dom.status.innerHTML="Light Fever 440 stopped",console.log("LightFever440 : Light system successfully stopped")})).catch((function(t){e._dom.status.innerHTML="Unable to stop Light Fever 440",console.error("LightFever440 : Unable to stop light system",t)}))}},{key:"_switchMode",value:function(e){var t=this;"false"===e.target.dataset.manual?(this._dom.manual.classList.remove("selected"),this._dom.analyzer.classList.add("selected"),this._dom.selection.style.left="50%",this._dom.manualContainer.style.left="-100%",this._dom.autoContainer.style.left="0",this._mode="AUDIO_ANALYSE",this._dom.status.innerHTML="Audio analyzer activated",this._effect=this._ac.getActiveEffect()):(this._dom.analyzer.classList.remove("selected"),this._dom.manual.classList.add("selected"),this._dom.selection.style.left="0",this._dom.manualContainer.style.left="0",this._dom.autoContainer.style.left="100%",this._mode="MANUAL",this._dom.status.innerHTML="Manual control activated",this._effect=this._mc.getActiveEffect()),!0===this._isActive&&this.sendAction().then((function(){t._dom.status.innerHTML="Switched to mode ".concat(t._mode),console.log("LightFever440 : Light system mode successfully switched")})).catch((function(e){t._dom.status.innerHTML="Unable to switch mode",console.error("LightFever440 : Unable to switch the light system mode",e)}))}},{key:"_startStroboscope",value:function(e){var t=this;"global-stroboscope"===e.target.id&&(e.preventDefault(),this._previousEffect=this._effect,this._dom.globalButtons.STROBOSCOPE.classList.add("selected"),this._effect="STROBOSCOPE",!0===this._isActive&&this.sendAction().then((function(){t._dom.status.innerHTML="Stroboscope activated",console.log("LightFever440 : Light system stroboscope successfully started")})).catch((function(e){t._dom.status.innerHTML="Unable to start stroboscope",console.error("LightFever440 : Unable to start the stroboscope effect",e)})))}},{key:"_stopStroboscope",value:function(){var e=this;this._effect=this._previousEffect,this._previousEffect=null,this._dom.globalButtons.STROBOSCOPE.classList.remove("selected"),!0===this._isActive&&this.sendAction().then((function(){e._dom.status.innerHTML="Stroboscope deactivated",console.log("LightFever440 : Light system stroboscope successfully stopped")})).catch((function(t){e._dom.status.innerHTML="Unable to stop stroboscope",console.error("LightFever440 : Unable to stop the stroboscope effect",t)}))}},{key:"_setOptionsForEffect",value:function(){"MANUAL"===this._mode?this._options=this._mc.getOptions():this._options=this._ac.getOptions(),"STROBOSCOPE"===this._effect&&(this._options={color:s(window.localStorage.getItem("strob-color")),delay:parseInt(window.localStorage.getItem("strob-delay"))||50}),console.log("LightFever440 : Effect ".concat(this._effect,", Options"),this._options)}},{key:"_switchTheme",value:function(e){!0===e.target.checked?(this._isDark=!1,document.body.classList.remove("dark-theme"),document.body.classList.add("light-theme"),this._dom.status.innerHTML="Switched to light theme",window.localStorage.setItem("theme","light")):(this._isDark=!0,document.body.classList.remove("light-theme"),document.body.classList.add("dark-theme"),this._dom.status.innerHTML="Switched to dark theme",window.localStorage.setItem("theme","dark"))}},{key:"_stroboscopeModal",value:function(){new i("STROBOSCOPE")}},{key:"_getState",value:function(){return new Promise((function(e,t){a("state").then(e).catch(t)}))}},{key:"sendAction",value:function(){var e=this;return new Promise((function(t,o){e._setOptionsForEffect(),a("action",{state:e._state,mode:e._mode,effect:e._effect,options:e._options}).then(t).catch(o).finally((function(){e._options=null}))}))}},{key:"isActive",get:function(){return this._isActive}},{key:"effect",get:function(){return this._effect},set:function(e){this._effect=e}},{key:"status",set:function(e){this._dom.status.innerHTML=e}}])&&g(t.prototype,o),e}();window.LF440=new p;var w=p}},t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}return o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o(215)}().default;